subsystem = NFIRAOS
component = ngsSsm

publish {
  events = [
    {
      name            = state
      description     = NGS SSM assembly state
      attributes      = [
        {
          name        = cmd
          description = NGS SSM assembly command state
          enum        = [ UNINITIALIZED, READY, BUSY, CONTINUOUS ]
        }
        {
          name        = move
          description = NGS SSM assembly movement state
          type        = boolean
        }
        {
          name        = dither
          description = telescope dither state assumed by the SSM
          type        = boolean
        }
        {
          name        = ss
          description = flag indicating if SS mode is enabled
          type        = boolean
        }
        {
          name        = onTarget
          description = Current NGS SSM position within tolerance of the target position.
          type        = boolean
        }
      ]
    }

    {
      name            = trackingError
      description     = """The tracking error is outside of the acceptable limits, while in follow mode (state.cmd == CONTINUOUS).

*Notable Event.*
"""
      maxRate         = 20
      archive         = true
      attributes      = [
        {
          name        = state
          description = "State of the Notable Event"
          type        = boolean
        }
        {
          name        = msg
          description = "Error message describing the Notable Event"
          type        = string
        }
      ]
    }

  ]

  telemetry = [

    {
      name            = ssTarget
      description     = "target position of an SS NGS source for SSM following in SS mode. This position is used instead of the PWFS position stream from the TCS."
      attributes      = [
        {
          name        = x
          description = "target NGS SSM x position for SS NGS source."
          type        = double
          units       = "mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength"
        }
        {
          name        = y
          description = "target NGS SSM x position for SS NGS source."
          type        = double
          units       = "mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength"
        }
      ]
    }

    {
      name            = target
      description     = "Target NGS SSM positions."
      attributes      = [
        {
          name        = imageX
          description = "Net target NGS SSM x-axis image position, based on TCS stream/NSS position plus integrated TT errors from the RTC."
          type        = double
          units       = "mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageY
          description = "Net target NGS SSM y-axis image position, based on TCS stream/NSS position plus integrated TT errors from the RTC."
          type        = double
          units       = """mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = integratorTip
          description = "Tip value stored in the integrator, based on tip errors from the RTC."
          type        = double
          units       = "Arcsec on the sky in FCRS<sub>174.5</sub>"
        }
        {
          name        = integratorTilt
          description = "Tilt value stored in the integrator, based on tilt errors from the RTC."
           type        = double
          units       = "Arcsec on the sky in FCRS<sub>174.5</sub>"
        }
        {
          name        = pupilX
          description = "Target NGS SSM x-axis pupil offset, based on expected ADC error from the NGS ADC."
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilY
          description = "Target NGS SSM y-axis pupil offset, based on expected ADC error from the NGS ADC."
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = focus
          description = "Target NGS SSM focus value stored in the integrator, based on focus errors from the RTC."
          type        = double
          units       = "&mu;m of RMS wavefront error in FCRS<sub>174.5</sub>"
        }
        {
          name        = stageX
          description = "target NGS SSM X-axis stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageY
          description = "target NGS SSM Y-axis stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageTip
          description = "target NGS SSM tip stage position."
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageTilt
          description = "target NGS SSM tilt stage position."
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageFocus
          description = "target NGS SSM focus stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
      ]
    }

    {
      name            = current
      description     = """Current NGS SSM position."""
      maxRate         = 20
      attributes      = [
        {
          name        = datumX
          description = """Datum state of the SSM X-axis stage."""
          type        = boolean
        }
        {
          name        = datumY
          description = """Datum state of the SSM Y-axis stage."""
          type        = boolean
        }
        {
          name        = datumTip
          description = """Datum state of the SSM tip stage."""
          type        = boolean
        }
        {
          name        = datumTilt
          description = """Datum state of the SSM tilt stage."""
          type        = boolean
        }
        {
          name        = datumFocus
          description = """Datum state of the SSM focus stage."""
          type        = boolean
        }
        {
          name        = imageX
          description = "Current NGS SSM x-axis image position."
          type        = double
          units       = """mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageY
          description = "Current NGS SSM y-axis image position."
          type        = double
          units       = """mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageError
          description = """Current NGS SSM image position tracking error (= [(target.imageX-current.imageX)<sup>2</sup>+(target.imageY-current.imageY)<sup>2</sup>]<sup><sup>1</sup>/<sub>2</sub></sup>)."""
          type        = double
          units       = """mm in FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = pupilX
          description = "Current NGS SSM x-axis pupil offset."
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilY
          description = "Current NGS SSM y-axis pupil offset."
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilError
          description = """Current NGS SSM pupil offset tracking error (= [(target.pupilX-current.pupilX)<sup>2</sup>+(target.pupilY-current.pupilY)<sup>2</sup>]<sup><sup>1</sup>/<sub>2</sub></sup>)."""
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = focus
          description = "Current NGS SSM focus."
          type        = double
          units       = "&mu;m of RMS wavefront error in FCRS<sub>174.5</sub>"
        }
        {
          name        = focusError
          description = """Current NGS SSM focus tracking error (= target.focus-current.focus)"""
          type        = double
          units       = "&mu;m of RMS wavefront error in FCRS<sub>174.5</sub>"
        }
        {
          name        = stageX
          description = "Current NGS SSM x-axis stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageY
          description = "Current NGS SSM y-axis stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageTip
          description = "Current NGS SSM tip stage position."
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageTilt
          description = "Current NGS SSM tilt stage position."
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageFocus
          description = "Current NGS SSM focus stage position."
          type        = double
          units       = "mm in local stage coordinate system"
        }
      ]
    }

  ]

  alarms = [
    {
      name = limitX
      description = "NGS SSM x-axis stage has reached a limit"
      severity = major
      archive = true
    }
    {
      name = limitY
      description = "NGS SSM Y-axis stage has reached a limit"
      severity = major
      archive = true
    }
    {
      name = limitTip
      description = "NGS SSM tip stage has reached a limit"
      severity = major
      archive = true
    }
    {
      name = limitTilt
      description = "NGS SSM tilt stage has reached a limit"
      severity = major
      archive = true
    }
    {
      name = limitFocus
      description = "NGS SSM focus stage has reached a limit"
      severity = major
      archive = true
    }
    {
      name = posErrX
      description = "The NGS SSM X-axis stage has an unacceptable position error, datum may be lost."
      severity = major
      archive = true
    }
    {
      name = posErrY
      description = "The NGS SSM Y-axis stage has an unacceptable position error, datum may be lost."
      severity = major
      archive = true
    }
    {
      name = posErrTip
      description = "The NGS SSM tip stage has an unacceptable position error, datum may be lost."
      severity = major
      archive = true
    }
    {
      name = posErrTilt
      description = "The NGS SSM tilt stage has an unacceptable position error, datum may be lost."
      severity = major
      archive = true
    }
    {
      name = posErrFocus
      description = "The NGS SSM focus stage has an unacceptable position error, datum may be lost."
      severity = major
      archive = true
    }
  ]

}
