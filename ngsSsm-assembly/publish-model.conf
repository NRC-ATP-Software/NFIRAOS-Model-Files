subsystem = NFIRAOS
component = ngsSsm

publish {
  events = [
    {
      name            = state
      description     = NGS SSM assembly state
      attributes      = [
        {
          name        = cmd
          description = NGS SSM assembly command state
          enum        = [ UNINITIALIZED, READY, BUSY, CONTINUOUS ]
        }
        {
          name        = move
          description = NGS SSM assembly movement state
          enum        = [ UNINDEXED, INDEXING, INDEXED, MOVING ]
        }
        {
          name        = dither
          description = telescope dither state assumed by the SSM
          type        = boolean
        }
        {
          name        = ss 
          description = flag indicating if SS mode is enabled
          type        = boolean
        }
        {
          name        = onTarget
          description = Current NGS SSM position within tolerance of the target position.
          type        = boolean
        }
      ]
    }


    {
      name            = ssTarget 
      description     = "target position of an SS NGS source for following in SS mode. This position is used instead of the PWFS position stream from the TCS."
      attributes      = [
        {
          name        = x
          description = target NGS SSM x position for SS NGS source.
          type        = double
          units       = "mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength"
        }
        {
          name        = y
          description = target NGS SSM x position for SS NGS source.
          type        = double
          units       = "mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength"
        }
      ]
    }

    {
      name            = target
      description     = Target NGS SSM positions.
      attributes      = [
        {
          name        = imageX
          description = Target NGS SSM x-axis image position.
          type        = double
          units       = "mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageY
          description = Target NGS SSM y-axis image position.
          type        = double
          units       = """mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = pupilX
          description = Target NGS SSM x-axis pupil offset.
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilY
          description = Target NGS SSM y-axis pupil offset.
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = focus
          description = Target NGS SSM focus.
          type        = double
          units       = """micrometers of RMS wavefront."""
        }
        {
          name        = stageX
          description = target NGS SSM x-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageY
          description = target NGS SSM y-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageTip
          description = target NGS SSM tip-axis stage position.
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageTilt
          description = target NGS SSM tilt-axis stage position.
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageFocus
          description = target NGS SSM focus-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
      ]
    }

    {
      name            = current
      description     = """Current NGS SSM position.

If the motors have not been indexed (state.move == UNINDEXED | INDEXING), then the positions are invalid and will be set to zero."""
      maxRate         = 20
      attributes      = [
        {
          name        = imageX
          description = Current NGS SSM x-axis image position.
          type        = double
          units       = """mm in X-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageY
          description = Current NGS SSM y-axis image position.
          type        = double
          units       = """mm in Y-axis of FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = imageError
          description = """Current NGS SSM image position tracking error (= [(target.imageX-current.imageX)<sup>2</sup>+(target.imageY-current.imageY)<sup>2</sup>]<sup><sup>1</sup>/<sub>2</sub></sup>)."""
          type        = double
          units       = """mm in FCRS<sub>174.5</sub> at reference wavelength."""
        }
        {
          name        = pupilX
          description = Current NGS SSM x-axis pupil offset.
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilY
          description = Current NGS SSM y-axis pupil offset.
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = pupilError
          description = """Current NGS SSM pupil offset tracking error (= [(target.pupilX-current.pupilX)<sup>2</sup>+(target.pupilY-current.pupilY)<sup>2</sup>]<sup><sup>1</sup>/<sub>2</sub></sup>)."""
          type        = double
          units       = """fraction of pupil diameter shift in FCRS<sub>174.5</sub>."""
        }
        {
          name        = focus
          description = Current NGS SSM focus.
          type        = double
          units       = """micrometers of RMS wavefront."""
        }
        {
          name        = focusError
          description = """Current NGS SSM focus tracking error (= target.focus-current.focus)"""
          type        = double
          units       = """micrometers of RMS wavefront."""
        }
        {
          name        = stageX
          description = Current NGS SSM x-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageY
          description = Current NGS SSM y-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
        {
          name        = stageTip
          description = Current NGS SSM tip-axis stage position.
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageTilt
          description = Current NGS SSM tilt-axis stage position.
          type        = double
          units       = "degrees in local stage coordinate system"
        }
        {
          name        = stageFocus
          description = Current NGS SSM focus-axis stage position.
          type        = double
          units       = "mm in local stage coordinate system"
        }
      ]
    }
  
  ] 
  
  alarms = [
    {
      name = limitX
      description = NGS SSM x-axis stage has reached a limit
      severity = major
      archive = true
    }
    {
      name = limitY
      description = NGS SSM Y-axis stage has reached a limit
      severity = major
      archive = true
    }
    {
      name = limitTip
      description = NGS SSM tip-axis stage has reached a limit
      severity = major
      archive = true
    }
    {
      name = limitTilt
      description = NGS SSM tilt-axis stage has reached a limit
      severity = major
      archive = true
    }
{
      name = limitFocus
      description = NGS SSM focus-axis stage has reached a limit
      severity = major
      archive = true
    }

  ]

}
